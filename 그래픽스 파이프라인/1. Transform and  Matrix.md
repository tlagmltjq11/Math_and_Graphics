## Transform과 행렬
3차원 공간에서 위치와 방향을 갖는 벡터는 선형변환을 통해 이동(아핀변환), 회전, 스케일이 가능하다는 것을 위 내용들에서 배울 수 있었다.<br>
즉 특정 행렬과의 곱셈을 통해서 이동, 회전, 스케일링 등이 가능하다는 것이다.<br>
(행렬은 여러 개의 연립방정식을 하나로 표현할 수 있는 강력한 도구)<br>

Unity의 Transform 시스템이 이러한 행렬 곱셈의 프로세스로 이루어져 있다.<br>
그래픽스 파이프라인 과정 중 **정점 파이프라인 과정** 이있는데, 쉽게말하면 가상 3D공간을 모니터의 2D공간으로 변환하는 과정이다.<br>
**로컬좌표계 -> 월드좌표계 -> 카메라좌표계 -> 투영좌표계 -> 뷰포트** 와 같이 프로세스가 구성되어 있으며<br>
여기서 월드좌표계로의 변환을 유니티의 **트랜스폼** 컴포넌트가 담당하고 있으며, 그외 카메라, 투영, 뷰포트 변환은 **카메라** 컴포넌트가 담당한다.<br>
<br>

지금부터 월드좌표계로의 변환을 알아보자.<br>

**동차좌표계**<br>
우선 알아야 할 것이 **동차좌표계**에 대한 개념이다.<br>
동차좌표계란 어떤 목적을 위해 한 차원의 좌표(n)를 추가한 좌표 (n+1)로 표현을 하는 것을 동차 좌표계다.<br>
즉, 유니티에서 3차원의 좌표에 w를 더해 4차원의 좌표 (x,y,z,w)와 같이 표현하는 것을 의미한다.<br>

**이유 1 : 4 x 4 Matrix 연산을 위함.**<br>
이런 동차좌표계를 사용하는데에는 여러 이유가 있겠지만, 가장 단편적인 이유는 **이동** 과 관련된 부분 때문이다.<br>
![좌표덧셈](https://user-images.githubusercontent.com/43705434/120304360-af1dff00-c30a-11eb-987c-be2750e31efb.PNG)<br>
이동은 위와 같이 기존 좌표에 상수를 더하여 벡터를 이동시키는 것을 의미하는데, 행렬과 벡터의 곱셈으로 표현이 안된다.<br>
<br>

![이동행렬](https://user-images.githubusercontent.com/43705434/120304347-ad543b80-c30a-11eb-898d-e3f2e519b290.PNG)<br>
행렬의 곱으로 각 좌표에 상수를 더하기 위해선 어쩔 수 없이 좌표 하나를 추가하여 4x4행렬과 4열을 가진 열벡터를 만들어줘야 한다.<br>
위와 같이 벡터의 마지막 행인 1이 dx, dy, dz와 곱해져 각 좌표에 더해질 수 있다.<br>
<br>

이동 행렬이 이와 같이 동차좌표계를 사용하기 때문에, 스케일, 회전 또한 동차좌표계로 표현하여야만 서로의 곱셈이 가능해진다.<br>
따라서 모든 변환 행렬은 4x4 행렬을 사용하게 된다.<br>
(사실 아핀공간, 아핀변환의 관점에서도 바라봐야 제대로 된 해석이 된다. 아핀공간이란 **위치** 를 나타내기 위한 **점** 이라는 개념이 도입된 공간)<br>
->> Affine : https://luv-n-interest.tistory.com/810 , https://blog.daum.net/shksjy/229 <br>
<br>

점은 위치의 개념이기에 원점으로 부터의 상대적인 위치로 계산된다. 즉 원점으로 멀어지거나 가까워지거나..<br>
반면 벡터는 원점과 상관없이 그 자체로 변환된다.<br>
![점과 벡터의 차이](https://user-images.githubusercontent.com/43705434/120304352-adecd200-c30a-11eb-811e-950b3f453fd0.PNG)<br>
![점과 벡터의 차이 2](https://user-images.githubusercontent.com/43705434/120304357-ae856880-c30a-11eb-8306-ff499b83318b.PNG)<br>
<br>
<br>

**이유 2 : 벡터와 점을 구분짓기 위함.**<br>
벡터 공간의 한 벡터 u(1,2,3)과 아핀 공간의 한 점 p(1,2,3)은 분명 다른 개념이지만, 컴퓨터는 이를 다르게 해석할 수 없다.<br>
그렇기에 w값을 통해서 구분지어줘야 한다.<br>

3차원 아핀 공간의 점 p(1,2,3), 점 q(2,4,6), 벡터 u(1,2,3), 벡터 v(2,4,6) 4가지를 가지고 생각해보자.<br>
아핀 공간에서 점 p와 점 q는 다르지만 벡터 u와 벡터 v는 같다.<br>

**벡터의 경우**<br>
동차 좌표계(x, y, z,ω)로 벡터 u, v를 나타냈을때 ω값으로 0 을 주면 u(1,2,3,0), v(2,4,6,0) 이렇게 나타 낼 수 있고<br>
v의 모든 인자를 2로 나누면 u,v 모두 (1,2,3,0)이므로 같은 벡터임을 알 수 있다.<br>
ω값으로 0을 주게 되면 (x, y, z)의 비율이 같으면 모두 같은 벡터로 볼 수 있다는 것.<br>
<br>

**점의 경우**<br>
점 p 점 q가 다르기 때문에 점 q의 x, y, z값을 2로 나누었을 때 4번째 인자 ω의 값이 점 p와 달라야 두 점이 다르다고 나타 낼 수 있다.<br>
따라서 w값으로 0이 아닌 특정한 값을 기준으로 정해주어야 하고, 1을 사용하기로 기준을 정해 놓았다.<br>
그래서 (2,4,6,1)을 2로 나누면 (1,2,3,1/2)이므로 (1,2,3,1)과 다른 점이다.<br>
(1,2,3,1)과 (2,4,6,2)는 모두 3차원의 점(1,2,3)이다.<br>
<br>

**즉 0은 벡터, 1은 점을 나타낸다.**<br>
<br>

이유 3 : 원근투영을 위함.<br>
추후 업데이트<br>
<br>
<br>

![스케일변환행렬](https://user-images.githubusercontent.com/43705434/120305131-631f8a00-c30b-11eb-904a-b4edd9c61cb0.PNG)<br>
![회전행렬](https://user-images.githubusercontent.com/43705434/120305130-6286f380-c30b-11eb-8195-2683d17c9463.PNG)<br>
![위치행렬](https://user-images.githubusercontent.com/43705434/120305132-631f8a00-c30b-11eb-94ad-40f983886436.PNG)<br>
<br>

이동변환, 스케일변환, 회전변환(x, ,y , z) 설명.

스케일 x 회전(x, y, z) x 이동 순서로 로컬좌표에 곱해줘야 제대로된 월드좌표계가 나온다.
주의! 행렬의 곱셈은 교환법칙이 성립하지않는다.

이유 : 스케일 변환은 회전 변환에 영향을 받고 또한, 회전 변환은 이동 변환에 영향을 받기 때문에.
이동 변환 후 회전 변환을 하면 객체가 이동 된 지점을 기준으로 회전하기 때문에 위치가 달라진다.
